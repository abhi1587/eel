<!DOCTYPE html><head><meta charset="UTF-8"><title>3 D laser welding | Eel</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Eel</a><a href="https://github.com/hugary1995/eel" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../eel.html">Documentation</a></li></ul><a href="#" class="sidenav-trigger" data-target="f5e5fab0-caba-4d2b-a87f-6995c44571fc"><i class="material-icons">menu</i></a><ul class="sidenav" id="f5e5fab0-caba-4d2b-a87f-6995c44571fc"><li><a href="../../eel.html">Documentation</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">modules</span><a href="." class="breadcrumb">navier_stokes</a><a href="#" class="breadcrumb">laser_welding</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="fa1b5148-3c55-44bd-8f0c-12d1c96441f2" data-section-level="1" data-section-text="3 D laser welding"><h1 id="3-d-laser-welding">3D laser welding</h1><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">comment</i><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p>This input requires tests objects. It can only be run with the Navier Stokes module executable or an application that also compiled the Navier Stokes test objects. The <code>--allow-test-objects</code> argument must be passed on the command line as well.</p></div></div></div><p>The input file below can be used to model a full rotation of a laser spot around the surface of a cubic representation of a welding material. This input, whose results are published in <a href="#lindsay2021automatic">Lindsay et al. (2021)</a>, reproduces a model outlined in <a href="#noble2007use">Noble et al. (2007)</a>. A simple Laplacian equation is used to model the displacement field:</p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[disp_x]
  type = Diffusion
  variable = disp_x
[]

[disp_y]
  type = Diffusion
  variable = disp_y
[]

[disp_z]
  type = Diffusion
  variable = disp_z
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#dfc0df83-c1d2-4ede-bb1c-8e6c8939030f">(moose/modules/navier_stokes/examples/laser-welding/3d.i)</a><p>The incompressible Navier-Stokes equations are solved for mass, momentum, and energy. These equations are run on the displaced mesh such that a mesh convection term (see <a href="../../source/kernels/INSADMeshConvection.html">INSADMeshConvection</a>) must be added to correct the material velocity, as shown in equation 2 of <a href="#kong2017scalable">Kong and Cai (2017)</a>. Both SUPG and PSPG stabilizations are used in this input. The kernels used to model the Navier-Stokes equations are shown below:</p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[Kernels]
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#94b11314-0603-4043-b30d-a756172392a0">(moose/modules/navier_stokes/examples/laser-welding/3d.i)</a><p>This simulation is driven by the rotating laser spot, whose effect is introduced via the <a href="../../source/bcs/GaussianEnergyFluxBC.html">GaussianEnergyFluxBC</a> object</p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[weld_flux]
  type = GaussianEnergyFluxBC
  variable = T
  boundary = &#x27;front&#x27;
  P0 = 159.96989792079225
  R = 1.8257418583505537e-4
  x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
  y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
  z_beam_coord = 0
  use_displaced_mesh = true
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#f306f1c2-a6b4-4c88-95b8-efa6606f49b2">(moose/modules/navier_stokes/examples/laser-welding/3d.i)</a><p>In addition to this incoming heat flux, an outgoing radiative heat flux is modeled using <a href="../../source/bcs/FunctionRadiativeBC.html">FunctionRadiativeBC</a></p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[radiation_flux]
  type = FunctionRadiativeBC
  variable = T
  boundary = &#x27;front&#x27;
  emissivity_function = &#x27;1&#x27;
  Tinfinity = 300
  stefan_boltzmann_constant = ${sb}
  use_displaced_mesh = true
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#f6f37d34-978a-4ac2-a524-9bc3fa2b58c1">(moose/modules/navier_stokes/examples/laser-welding/3d.i)</a><p>Evaporation of material from the liquefied material surface helps drive momentum changes at the surface of the condensed phase; this effect is incorporated via the <a href="../../source/bcs/INSADVaporRecoilPressureMomentumFluxBC.html">INSADVaporRecoilPressureMomentumFluxBC</a> object</p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[vapor_recoil]
  type = INSADVaporRecoilPressureMomentumFluxBC
  variable = vel
  boundary = &#x27;front&#x27;
  use_displaced_mesh = true
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#355f60be-b69d-48ea-8f8a-cde0a3b9e4d3">(moose/modules/navier_stokes/examples/laser-welding/3d.i)</a><p>These surface momentum and velocity changes are then translated into mesh displacement through <a href="../../source/bcs/INSADDisplaceBoundaryBC.html">INSADDisplaceBoundaryBC</a> objects</p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[displace_x_top]
  type = INSADDisplaceBoundaryBC
  boundary = &#x27;front&#x27;
  variable = &#x27;disp_x&#x27;
  velocity = &#x27;vel&#x27;
  component = 0
[]

[displace_y_top]
  type = INSADDisplaceBoundaryBC
  boundary = &#x27;front&#x27;
  variable = &#x27;disp_y&#x27;
  velocity = &#x27;vel&#x27;
  component = 1
[]

[displace_z_top]
  type = INSADDisplaceBoundaryBC
  boundary = &#x27;front&#x27;
  variable = &#x27;disp_z&#x27;
  velocity = &#x27;vel&#x27;
  component = 2
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#62a1195f-40fe-4787-9b4d-135c62ff11b7">(moose/modules/navier_stokes/examples/laser-welding/3d.i)</a><p>We also introduce <a href="../../source/bcs/INSADDummyDisplaceBoundaryIntegratedBC.html">INSADDummyDisplaceBoundaryIntegratedBC</a> objects in order to fill the sparsity dependence of the surface displacement degrees of freedom on the surface velocity degrees of freedom before the Jacobian matrix is assembled prior to executing nodal boundary conditions. This sparsity filling is necessary in order to prevent new nonzero allocations from occurring when the <code>INSADDisplaceBoundaryBC</code> nodal boundary conditions are executed.</p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[displace_x_top_dummy]
  type = INSADDummyDisplaceBoundaryIntegratedBC
  boundary = &#x27;front&#x27;
  variable = &#x27;disp_x&#x27;
  velocity = &#x27;vel&#x27;
  component = 0
[]

[displace_y_top_dummy]
  type = INSADDummyDisplaceBoundaryIntegratedBC
  boundary = &#x27;front&#x27;
  variable = &#x27;disp_y&#x27;
  velocity = &#x27;vel&#x27;
  component = 1
[]

[displace_z_top_dummy]
  type = INSADDummyDisplaceBoundaryIntegratedBC
  boundary = &#x27;front&#x27;
  variable = &#x27;disp_z&#x27;
  velocity = &#x27;vel&#x27;
  component = 2
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#22851f00-6e56-4d41-9e11-24ec92ddefad">(moose/modules/navier_stokes/examples/laser-welding/3d.i)</a><p>No-slip boundary conditions are applied at all surfaces other than at the <code>front</code> surface where the laser spot is applied</p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[no_slip]
  type = ADVectorFunctionDirichletBC
  variable = vel
  boundary = &#x27;bottom right left top back&#x27;
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#8ab3f351-b9fd-4229-aff0-9f4ff71a7e75">(moose/modules/navier_stokes/examples/laser-welding/3d.i)</a><p>The <code>back</code> surface is held at a constant temperature of 300 Kelvin</p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[T_cold]
  type = DirichletBC
  variable = T
  boundary = &#x27;back&#x27;
  value = 300
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#d547e45e-185e-4914-ac94-aa76aada9d00">(moose/modules/navier_stokes/examples/laser-welding/3d.i)</a><p>Zero displacements are applied at the <code>back</code> surface</p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[x_no_disp]
  type = DirichletBC
  variable = disp_x
  boundary = &#x27;back&#x27;
  value = 0
[]

[y_no_disp]
  type = DirichletBC
  variable = disp_y
  boundary = &#x27;back&#x27;
  value = 0
[]

[z_no_disp]
  type = DirichletBC
  variable = disp_z
  boundary = &#x27;back&#x27;
  value = 0
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#8101299a-7527-49f6-b4da-38e91715cc87">(moose/modules/navier_stokes/examples/laser-welding/3d.i)</a><p>Material properties are based on 304L stainless steel</p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[steel]
  type = AriaLaserWeld304LStainlessSteel
  temperature = T
  beta = 1e7
[]

[steel_boundary]
  type = AriaLaserWeld304LStainlessSteelBoundary
  boundary = &#x27;front&#x27;
  temperature = T
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#489aaf62-4f69-4eea-9b23-0d15e34ffce0">(moose/modules/navier_stokes/examples/laser-welding/3d.i)</a><p>The full input is listed below</p><pre class="moose-pre" style="max-height:350px;"><code class="language-text">period=1.25e-3
endtime=${period}
timestep=1.25e-5
surfacetemp=300
sb=5.67e-8

[GlobalParams]
  temperature = T
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  xmin = -.35e-3
  xmax = 0.35e-3
  ymin = -.35e-3
  ymax = .35e-3
  zmin = -.7e-3
  zmax = 0
  nx = 2
  ny = 2
  nz = 2
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  uniform_refine = 2
[]

[Variables]
  [vel]
    family = LAGRANGE_VEC
  []
  [T]
  []
  [p]
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[ICs]
  [T]
    type = FunctionIC
    variable = T
    function = &#x27;(${surfacetemp} - 300) / .7e-3 * z + ${surfacetemp}&#x27;
  []
[]

[Kernels]
  [disp_x]
    type = Diffusion
    variable = disp_x
  []
  [disp_y]
    type = Diffusion
    variable = disp_y
  []
  [disp_z]
    type = Diffusion
    variable = disp_z
  []
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]

[BCs]
  [x_no_disp]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;back&#x27;
    value = 0
  []
  [y_no_disp]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back&#x27;
    value = 0
  []
  [z_no_disp]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0
  []
  [no_slip]
    type = ADVectorFunctionDirichletBC
    variable = vel
    boundary = &#x27;bottom right left top back&#x27;
  []
  [T_cold]
    type = DirichletBC
    variable = T
    boundary = &#x27;back&#x27;
    value = 300
  []
  [radiation_flux]
    type = FunctionRadiativeBC
    variable = T
    boundary = &#x27;front&#x27;
    emissivity_function = &#x27;1&#x27;
    Tinfinity = 300
    stefan_boltzmann_constant = ${sb}
    use_displaced_mesh = true
  []
  [weld_flux]
    type = GaussianEnergyFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    P0 = 159.96989792079225
    R = 1.8257418583505537e-4
    x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
    y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
    z_beam_coord = 0
    use_displaced_mesh = true
  []
  [vapor_recoil]
    type = INSADVaporRecoilPressureMomentumFluxBC
    variable = vel
    boundary = &#x27;front&#x27;
    use_displaced_mesh = true
  []
  [displace_x_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
  [displace_x_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
[]

[Materials]
  [ins_mat]
    type = INSADStabilized3Eqn
    velocity = vel
    pressure = p
    temperature = T
    use_displaced_mesh = true
  []
  [steel]
    type = AriaLaserWeld304LStainlessSteel
    temperature = T
    beta = 1e7
  []
  [steel_boundary]
    type = AriaLaserWeld304LStainlessSteelBoundary
    boundary = &#x27;front&#x27;
    temperature = T
  []
  [const]
    type = GenericConstantMaterial
    prop_names = &#x27;abs sb_constant&#x27;
    prop_values = &#x27;1 ${sb}&#x27;
  []
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_mat_solver_type&#x27;
    petsc_options_value = &#x27;lu       NONZERO               strumpack&#x27;
  []
[]

[Executioner]
  type = Transient
  end_time = ${endtime}
  dtmin = 1e-8
  dtmax = ${timestep}
  petsc_options = &#x27;-snes_converged_reason -ksp_converged_reason -options_left&#x27;
  solve_type = &#x27;NEWTON&#x27;
  line_search = &#x27;none&#x27;
  nl_max_its = 12
  l_max_its = 100
  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    dt = ${timestep}
    linear_iteration_ratio = 1e6
    growth_factor = 1.5
  []
[]

[Outputs]
  [exodus]
    type = Exodus
    output_material_properties = true
    show_material_properties = &#x27;mu&#x27;
  []
  checkpoint = true
  perf_graph = true
[]

[Debug]
  show_var_residual_norms = true
[]

[Adaptivity]
  marker = combo
  max_h_level = 4

  [Indicators]
    [error_T]
      type = GradientJumpIndicator
      variable = T
    []
    [error_dispz]
      type = GradientJumpIndicator
      variable = disp_z
    []
  []

  [Markers]
    [errorfrac_T]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_T
    []
    [errorfrac_dispz]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_dispz
    []
    [combo]
      type = ComboMarker
      markers = &#x27;errorfrac_T errorfrac_dispz&#x27;
    []
  []
[]

[Postprocessors]
  [num_dofs]
    type = NumDOFs
    system = &#x27;NL&#x27;
  []
  [nl]
    type = NumNonlinearIterations
  []
  [tot_nl]
    type = CumulativeValuePostprocessor
    postprocessor = &#x27;nl&#x27;
  []
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#09400f70-2fe7-4d2e-8514-4d06719058eb">(moose/modules/navier_stokes/examples/laser-welding/3d.i)</a><section class="scrollspy" id="db357587-b1e5-4445-9dcc-4b413f697e84" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="kong2017scalable">Fande Kong and Xiao-Chuan Cai.
A scalable nonlinear fluid–structure interaction solver based on a schwarz preconditioner with isogeometric unstructured coarse spaces in 3d.
<em>Journal of Computational Physics</em>, 340:498–518, 2017.<a href="#74980e0d-d943-4de7-b8eb-2e3dfd695d98" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="74980e0d-d943-4de7-b8eb-2e3dfd695d98"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{kong2017scalable,
    author = "Kong, Fande and Cai, Xiao-Chuan",
    title = "A scalable nonlinear fluid--structure interaction solver based on a Schwarz preconditioner with isogeometric unstructured coarse spaces in 3D",
    journal = "Journal of Computational Physics",
    volume = "340",
    pages = "498--518",
    year = "2017",
    publisher = "Elsevier"
}
</code></pre></div></div></li><li id="lindsay2021automatic">Alexander Lindsay, Roy Stogner, Derek Gaston, Daniel Schwen, Christopher Matthews, Wen Jiang, Larry&nbsp;K Aagesen, Robert Carlsen, Fande Kong, Andrew Slaughter, and others.
Automatic differentiation in metaphysicl and its applications in moose.
<em>Nuclear Technology</em>, 207(7):905–922, 2021.<a href="#8a39b229-db3f-4289-b455-6349e262fb4a" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="8a39b229-db3f-4289-b455-6349e262fb4a"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{lindsay2021automatic,
    author = "Lindsay, Alexander and Stogner, Roy and Gaston, Derek and Schwen, Daniel and Matthews, Christopher and Jiang, Wen and Aagesen, Larry K and Carlsen, Robert and Kong, Fande and Slaughter, Andrew and others",
    title = "Automatic differentiation in MetaPhysicL and its applications in MOOSE",
    journal = "Nuclear Technology",
    volume = "207",
    number = "7",
    pages = "905--922",
    year = "2021",
    publisher = "Taylor \\& Francis"
}
</code></pre></div></div></li><li id="noble2007use">David&nbsp;R Noble, Patrick&nbsp;K Notz, Mario&nbsp;J Martinez, and Andrew&nbsp;Michael Kraynik.
Use of aria to simulate laser weld pool dynamics for neutron generator production.
Technical Report, Sandia National Laboratories (SNL), Albuquerque, NM, and Livermore, CA …, 2007.<a href="#fbd471f2-261f-495e-af5f-a8662447ec58" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="fbd471f2-261f-495e-af5f-a8662447ec58"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@techreport{noble2007use,
    author = "Noble, David R and Notz, Patrick K and Martinez, Mario J and Kraynik, Andrew Michael",
    title = "Use of Aria to simulate laser weld pool dynamics for neutron generator production.",
    year = "2007",
    institution = "Sandia National Laboratories (SNL), Albuquerque, NM, and Livermore, CA\textasciitilde …"
}
</code></pre></div></div></li></ol></div></section></section><div class="moose-modal modal" id="dfc0df83-c1d2-4ede-bb1c-8e6c8939030f"><div class="modal-content"><h4>(moose/modules/navier_stokes/examples/laser-welding/3d.i)</h4><pre class="moose-pre"><code class="language-text">period=1.25e-3
endtime=${period}
timestep=1.25e-5
surfacetemp=300
sb=5.67e-8

[GlobalParams]
  temperature = T
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  xmin = -.35e-3
  xmax = 0.35e-3
  ymin = -.35e-3
  ymax = .35e-3
  zmin = -.7e-3
  zmax = 0
  nx = 2
  ny = 2
  nz = 2
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  uniform_refine = 2
[]

[Variables]
  [vel]
    family = LAGRANGE_VEC
  []
  [T]
  []
  [p]
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[ICs]
  [T]
    type = FunctionIC
    variable = T
    function = &#x27;(${surfacetemp} - 300) / .7e-3 * z + ${surfacetemp}&#x27;
  []
[]

[Kernels]
  [disp_x]
    type = Diffusion
    variable = disp_x
  []
  [disp_y]
    type = Diffusion
    variable = disp_y
  []
  [disp_z]
    type = Diffusion
    variable = disp_z
  []
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]

[BCs]
  [x_no_disp]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;back&#x27;
    value = 0
  []
  [y_no_disp]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back&#x27;
    value = 0
  []
  [z_no_disp]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0
  []
  [no_slip]
    type = ADVectorFunctionDirichletBC
    variable = vel
    boundary = &#x27;bottom right left top back&#x27;
  []
  [T_cold]
    type = DirichletBC
    variable = T
    boundary = &#x27;back&#x27;
    value = 300
  []
  [radiation_flux]
    type = FunctionRadiativeBC
    variable = T
    boundary = &#x27;front&#x27;
    emissivity_function = &#x27;1&#x27;
    Tinfinity = 300
    stefan_boltzmann_constant = ${sb}
    use_displaced_mesh = true
  []
  [weld_flux]
    type = GaussianEnergyFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    P0 = 159.96989792079225
    R = 1.8257418583505537e-4
    x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
    y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
    z_beam_coord = 0
    use_displaced_mesh = true
  []
  [vapor_recoil]
    type = INSADVaporRecoilPressureMomentumFluxBC
    variable = vel
    boundary = &#x27;front&#x27;
    use_displaced_mesh = true
  []
  [displace_x_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
  [displace_x_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
[]

[Materials]
  [ins_mat]
    type = INSADStabilized3Eqn
    velocity = vel
    pressure = p
    temperature = T
    use_displaced_mesh = true
  []
  [steel]
    type = AriaLaserWeld304LStainlessSteel
    temperature = T
    beta = 1e7
  []
  [steel_boundary]
    type = AriaLaserWeld304LStainlessSteelBoundary
    boundary = &#x27;front&#x27;
    temperature = T
  []
  [const]
    type = GenericConstantMaterial
    prop_names = &#x27;abs sb_constant&#x27;
    prop_values = &#x27;1 ${sb}&#x27;
  []
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_mat_solver_type&#x27;
    petsc_options_value = &#x27;lu       NONZERO               strumpack&#x27;
  []
[]

[Executioner]
  type = Transient
  end_time = ${endtime}
  dtmin = 1e-8
  dtmax = ${timestep}
  petsc_options = &#x27;-snes_converged_reason -ksp_converged_reason -options_left&#x27;
  solve_type = &#x27;NEWTON&#x27;
  line_search = &#x27;none&#x27;
  nl_max_its = 12
  l_max_its = 100
  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    dt = ${timestep}
    linear_iteration_ratio = 1e6
    growth_factor = 1.5
  []
[]

[Outputs]
  [exodus]
    type = Exodus
    output_material_properties = true
    show_material_properties = &#x27;mu&#x27;
  []
  checkpoint = true
  perf_graph = true
[]

[Debug]
  show_var_residual_norms = true
[]


[Adaptivity]
  marker = combo
  max_h_level = 4

  [Indicators]
    [error_T]
      type = GradientJumpIndicator
      variable = T
    []
    [error_dispz]
      type = GradientJumpIndicator
      variable = disp_z
    []
  []

  [Markers]
    [errorfrac_T]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_T
    []
    [errorfrac_dispz]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_dispz
    []
    [combo]
      type = ComboMarker
      markers = &#x27;errorfrac_T errorfrac_dispz&#x27;
    []
  []
[]

[Postprocessors]
  [num_dofs]
    type = NumDOFs
    system = &#x27;NL&#x27;
  []
  [nl]
    type = NumNonlinearIterations
  []
  [tot_nl]
    type = CumulativeValuePostprocessor
    postprocessor = &#x27;nl&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="94b11314-0603-4043-b30d-a756172392a0"><div class="modal-content"><h4>(moose/modules/navier_stokes/examples/laser-welding/3d.i)</h4><pre class="moose-pre"><code class="language-text">period=1.25e-3
endtime=${period}
timestep=1.25e-5
surfacetemp=300
sb=5.67e-8

[GlobalParams]
  temperature = T
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  xmin = -.35e-3
  xmax = 0.35e-3
  ymin = -.35e-3
  ymax = .35e-3
  zmin = -.7e-3
  zmax = 0
  nx = 2
  ny = 2
  nz = 2
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  uniform_refine = 2
[]

[Variables]
  [vel]
    family = LAGRANGE_VEC
  []
  [T]
  []
  [p]
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[ICs]
  [T]
    type = FunctionIC
    variable = T
    function = &#x27;(${surfacetemp} - 300) / .7e-3 * z + ${surfacetemp}&#x27;
  []
[]

[Kernels]
  [disp_x]
    type = Diffusion
    variable = disp_x
  []
  [disp_y]
    type = Diffusion
    variable = disp_y
  []
  [disp_z]
    type = Diffusion
    variable = disp_z
  []
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]

[BCs]
  [x_no_disp]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;back&#x27;
    value = 0
  []
  [y_no_disp]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back&#x27;
    value = 0
  []
  [z_no_disp]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0
  []
  [no_slip]
    type = ADVectorFunctionDirichletBC
    variable = vel
    boundary = &#x27;bottom right left top back&#x27;
  []
  [T_cold]
    type = DirichletBC
    variable = T
    boundary = &#x27;back&#x27;
    value = 300
  []
  [radiation_flux]
    type = FunctionRadiativeBC
    variable = T
    boundary = &#x27;front&#x27;
    emissivity_function = &#x27;1&#x27;
    Tinfinity = 300
    stefan_boltzmann_constant = ${sb}
    use_displaced_mesh = true
  []
  [weld_flux]
    type = GaussianEnergyFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    P0 = 159.96989792079225
    R = 1.8257418583505537e-4
    x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
    y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
    z_beam_coord = 0
    use_displaced_mesh = true
  []
  [vapor_recoil]
    type = INSADVaporRecoilPressureMomentumFluxBC
    variable = vel
    boundary = &#x27;front&#x27;
    use_displaced_mesh = true
  []
  [displace_x_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
  [displace_x_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
[]

[Materials]
  [ins_mat]
    type = INSADStabilized3Eqn
    velocity = vel
    pressure = p
    temperature = T
    use_displaced_mesh = true
  []
  [steel]
    type = AriaLaserWeld304LStainlessSteel
    temperature = T
    beta = 1e7
  []
  [steel_boundary]
    type = AriaLaserWeld304LStainlessSteelBoundary
    boundary = &#x27;front&#x27;
    temperature = T
  []
  [const]
    type = GenericConstantMaterial
    prop_names = &#x27;abs sb_constant&#x27;
    prop_values = &#x27;1 ${sb}&#x27;
  []
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_mat_solver_type&#x27;
    petsc_options_value = &#x27;lu       NONZERO               strumpack&#x27;
  []
[]

[Executioner]
  type = Transient
  end_time = ${endtime}
  dtmin = 1e-8
  dtmax = ${timestep}
  petsc_options = &#x27;-snes_converged_reason -ksp_converged_reason -options_left&#x27;
  solve_type = &#x27;NEWTON&#x27;
  line_search = &#x27;none&#x27;
  nl_max_its = 12
  l_max_its = 100
  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    dt = ${timestep}
    linear_iteration_ratio = 1e6
    growth_factor = 1.5
  []
[]

[Outputs]
  [exodus]
    type = Exodus
    output_material_properties = true
    show_material_properties = &#x27;mu&#x27;
  []
  checkpoint = true
  perf_graph = true
[]

[Debug]
  show_var_residual_norms = true
[]


[Adaptivity]
  marker = combo
  max_h_level = 4

  [Indicators]
    [error_T]
      type = GradientJumpIndicator
      variable = T
    []
    [error_dispz]
      type = GradientJumpIndicator
      variable = disp_z
    []
  []

  [Markers]
    [errorfrac_T]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_T
    []
    [errorfrac_dispz]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_dispz
    []
    [combo]
      type = ComboMarker
      markers = &#x27;errorfrac_T errorfrac_dispz&#x27;
    []
  []
[]

[Postprocessors]
  [num_dofs]
    type = NumDOFs
    system = &#x27;NL&#x27;
  []
  [nl]
    type = NumNonlinearIterations
  []
  [tot_nl]
    type = CumulativeValuePostprocessor
    postprocessor = &#x27;nl&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="f306f1c2-a6b4-4c88-95b8-efa6606f49b2"><div class="modal-content"><h4>(moose/modules/navier_stokes/examples/laser-welding/3d.i)</h4><pre class="moose-pre"><code class="language-text">period=1.25e-3
endtime=${period}
timestep=1.25e-5
surfacetemp=300
sb=5.67e-8

[GlobalParams]
  temperature = T
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  xmin = -.35e-3
  xmax = 0.35e-3
  ymin = -.35e-3
  ymax = .35e-3
  zmin = -.7e-3
  zmax = 0
  nx = 2
  ny = 2
  nz = 2
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  uniform_refine = 2
[]

[Variables]
  [vel]
    family = LAGRANGE_VEC
  []
  [T]
  []
  [p]
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[ICs]
  [T]
    type = FunctionIC
    variable = T
    function = &#x27;(${surfacetemp} - 300) / .7e-3 * z + ${surfacetemp}&#x27;
  []
[]

[Kernels]
  [disp_x]
    type = Diffusion
    variable = disp_x
  []
  [disp_y]
    type = Diffusion
    variable = disp_y
  []
  [disp_z]
    type = Diffusion
    variable = disp_z
  []
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]

[BCs]
  [x_no_disp]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;back&#x27;
    value = 0
  []
  [y_no_disp]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back&#x27;
    value = 0
  []
  [z_no_disp]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0
  []
  [no_slip]
    type = ADVectorFunctionDirichletBC
    variable = vel
    boundary = &#x27;bottom right left top back&#x27;
  []
  [T_cold]
    type = DirichletBC
    variable = T
    boundary = &#x27;back&#x27;
    value = 300
  []
  [radiation_flux]
    type = FunctionRadiativeBC
    variable = T
    boundary = &#x27;front&#x27;
    emissivity_function = &#x27;1&#x27;
    Tinfinity = 300
    stefan_boltzmann_constant = ${sb}
    use_displaced_mesh = true
  []
  [weld_flux]
    type = GaussianEnergyFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    P0 = 159.96989792079225
    R = 1.8257418583505537e-4
    x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
    y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
    z_beam_coord = 0
    use_displaced_mesh = true
  []
  [vapor_recoil]
    type = INSADVaporRecoilPressureMomentumFluxBC
    variable = vel
    boundary = &#x27;front&#x27;
    use_displaced_mesh = true
  []
  [displace_x_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
  [displace_x_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
[]

[Materials]
  [ins_mat]
    type = INSADStabilized3Eqn
    velocity = vel
    pressure = p
    temperature = T
    use_displaced_mesh = true
  []
  [steel]
    type = AriaLaserWeld304LStainlessSteel
    temperature = T
    beta = 1e7
  []
  [steel_boundary]
    type = AriaLaserWeld304LStainlessSteelBoundary
    boundary = &#x27;front&#x27;
    temperature = T
  []
  [const]
    type = GenericConstantMaterial
    prop_names = &#x27;abs sb_constant&#x27;
    prop_values = &#x27;1 ${sb}&#x27;
  []
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_mat_solver_type&#x27;
    petsc_options_value = &#x27;lu       NONZERO               strumpack&#x27;
  []
[]

[Executioner]
  type = Transient
  end_time = ${endtime}
  dtmin = 1e-8
  dtmax = ${timestep}
  petsc_options = &#x27;-snes_converged_reason -ksp_converged_reason -options_left&#x27;
  solve_type = &#x27;NEWTON&#x27;
  line_search = &#x27;none&#x27;
  nl_max_its = 12
  l_max_its = 100
  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    dt = ${timestep}
    linear_iteration_ratio = 1e6
    growth_factor = 1.5
  []
[]

[Outputs]
  [exodus]
    type = Exodus
    output_material_properties = true
    show_material_properties = &#x27;mu&#x27;
  []
  checkpoint = true
  perf_graph = true
[]

[Debug]
  show_var_residual_norms = true
[]


[Adaptivity]
  marker = combo
  max_h_level = 4

  [Indicators]
    [error_T]
      type = GradientJumpIndicator
      variable = T
    []
    [error_dispz]
      type = GradientJumpIndicator
      variable = disp_z
    []
  []

  [Markers]
    [errorfrac_T]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_T
    []
    [errorfrac_dispz]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_dispz
    []
    [combo]
      type = ComboMarker
      markers = &#x27;errorfrac_T errorfrac_dispz&#x27;
    []
  []
[]

[Postprocessors]
  [num_dofs]
    type = NumDOFs
    system = &#x27;NL&#x27;
  []
  [nl]
    type = NumNonlinearIterations
  []
  [tot_nl]
    type = CumulativeValuePostprocessor
    postprocessor = &#x27;nl&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="f6f37d34-978a-4ac2-a524-9bc3fa2b58c1"><div class="modal-content"><h4>(moose/modules/navier_stokes/examples/laser-welding/3d.i)</h4><pre class="moose-pre"><code class="language-text">period=1.25e-3
endtime=${period}
timestep=1.25e-5
surfacetemp=300
sb=5.67e-8

[GlobalParams]
  temperature = T
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  xmin = -.35e-3
  xmax = 0.35e-3
  ymin = -.35e-3
  ymax = .35e-3
  zmin = -.7e-3
  zmax = 0
  nx = 2
  ny = 2
  nz = 2
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  uniform_refine = 2
[]

[Variables]
  [vel]
    family = LAGRANGE_VEC
  []
  [T]
  []
  [p]
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[ICs]
  [T]
    type = FunctionIC
    variable = T
    function = &#x27;(${surfacetemp} - 300) / .7e-3 * z + ${surfacetemp}&#x27;
  []
[]

[Kernels]
  [disp_x]
    type = Diffusion
    variable = disp_x
  []
  [disp_y]
    type = Diffusion
    variable = disp_y
  []
  [disp_z]
    type = Diffusion
    variable = disp_z
  []
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]

[BCs]
  [x_no_disp]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;back&#x27;
    value = 0
  []
  [y_no_disp]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back&#x27;
    value = 0
  []
  [z_no_disp]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0
  []
  [no_slip]
    type = ADVectorFunctionDirichletBC
    variable = vel
    boundary = &#x27;bottom right left top back&#x27;
  []
  [T_cold]
    type = DirichletBC
    variable = T
    boundary = &#x27;back&#x27;
    value = 300
  []
  [radiation_flux]
    type = FunctionRadiativeBC
    variable = T
    boundary = &#x27;front&#x27;
    emissivity_function = &#x27;1&#x27;
    Tinfinity = 300
    stefan_boltzmann_constant = ${sb}
    use_displaced_mesh = true
  []
  [weld_flux]
    type = GaussianEnergyFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    P0 = 159.96989792079225
    R = 1.8257418583505537e-4
    x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
    y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
    z_beam_coord = 0
    use_displaced_mesh = true
  []
  [vapor_recoil]
    type = INSADVaporRecoilPressureMomentumFluxBC
    variable = vel
    boundary = &#x27;front&#x27;
    use_displaced_mesh = true
  []
  [displace_x_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
  [displace_x_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
[]

[Materials]
  [ins_mat]
    type = INSADStabilized3Eqn
    velocity = vel
    pressure = p
    temperature = T
    use_displaced_mesh = true
  []
  [steel]
    type = AriaLaserWeld304LStainlessSteel
    temperature = T
    beta = 1e7
  []
  [steel_boundary]
    type = AriaLaserWeld304LStainlessSteelBoundary
    boundary = &#x27;front&#x27;
    temperature = T
  []
  [const]
    type = GenericConstantMaterial
    prop_names = &#x27;abs sb_constant&#x27;
    prop_values = &#x27;1 ${sb}&#x27;
  []
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_mat_solver_type&#x27;
    petsc_options_value = &#x27;lu       NONZERO               strumpack&#x27;
  []
[]

[Executioner]
  type = Transient
  end_time = ${endtime}
  dtmin = 1e-8
  dtmax = ${timestep}
  petsc_options = &#x27;-snes_converged_reason -ksp_converged_reason -options_left&#x27;
  solve_type = &#x27;NEWTON&#x27;
  line_search = &#x27;none&#x27;
  nl_max_its = 12
  l_max_its = 100
  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    dt = ${timestep}
    linear_iteration_ratio = 1e6
    growth_factor = 1.5
  []
[]

[Outputs]
  [exodus]
    type = Exodus
    output_material_properties = true
    show_material_properties = &#x27;mu&#x27;
  []
  checkpoint = true
  perf_graph = true
[]

[Debug]
  show_var_residual_norms = true
[]


[Adaptivity]
  marker = combo
  max_h_level = 4

  [Indicators]
    [error_T]
      type = GradientJumpIndicator
      variable = T
    []
    [error_dispz]
      type = GradientJumpIndicator
      variable = disp_z
    []
  []

  [Markers]
    [errorfrac_T]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_T
    []
    [errorfrac_dispz]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_dispz
    []
    [combo]
      type = ComboMarker
      markers = &#x27;errorfrac_T errorfrac_dispz&#x27;
    []
  []
[]

[Postprocessors]
  [num_dofs]
    type = NumDOFs
    system = &#x27;NL&#x27;
  []
  [nl]
    type = NumNonlinearIterations
  []
  [tot_nl]
    type = CumulativeValuePostprocessor
    postprocessor = &#x27;nl&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="355f60be-b69d-48ea-8f8a-cde0a3b9e4d3"><div class="modal-content"><h4>(moose/modules/navier_stokes/examples/laser-welding/3d.i)</h4><pre class="moose-pre"><code class="language-text">period=1.25e-3
endtime=${period}
timestep=1.25e-5
surfacetemp=300
sb=5.67e-8

[GlobalParams]
  temperature = T
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  xmin = -.35e-3
  xmax = 0.35e-3
  ymin = -.35e-3
  ymax = .35e-3
  zmin = -.7e-3
  zmax = 0
  nx = 2
  ny = 2
  nz = 2
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  uniform_refine = 2
[]

[Variables]
  [vel]
    family = LAGRANGE_VEC
  []
  [T]
  []
  [p]
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[ICs]
  [T]
    type = FunctionIC
    variable = T
    function = &#x27;(${surfacetemp} - 300) / .7e-3 * z + ${surfacetemp}&#x27;
  []
[]

[Kernels]
  [disp_x]
    type = Diffusion
    variable = disp_x
  []
  [disp_y]
    type = Diffusion
    variable = disp_y
  []
  [disp_z]
    type = Diffusion
    variable = disp_z
  []
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]

[BCs]
  [x_no_disp]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;back&#x27;
    value = 0
  []
  [y_no_disp]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back&#x27;
    value = 0
  []
  [z_no_disp]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0
  []
  [no_slip]
    type = ADVectorFunctionDirichletBC
    variable = vel
    boundary = &#x27;bottom right left top back&#x27;
  []
  [T_cold]
    type = DirichletBC
    variable = T
    boundary = &#x27;back&#x27;
    value = 300
  []
  [radiation_flux]
    type = FunctionRadiativeBC
    variable = T
    boundary = &#x27;front&#x27;
    emissivity_function = &#x27;1&#x27;
    Tinfinity = 300
    stefan_boltzmann_constant = ${sb}
    use_displaced_mesh = true
  []
  [weld_flux]
    type = GaussianEnergyFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    P0 = 159.96989792079225
    R = 1.8257418583505537e-4
    x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
    y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
    z_beam_coord = 0
    use_displaced_mesh = true
  []
  [vapor_recoil]
    type = INSADVaporRecoilPressureMomentumFluxBC
    variable = vel
    boundary = &#x27;front&#x27;
    use_displaced_mesh = true
  []
  [displace_x_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
  [displace_x_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
[]

[Materials]
  [ins_mat]
    type = INSADStabilized3Eqn
    velocity = vel
    pressure = p
    temperature = T
    use_displaced_mesh = true
  []
  [steel]
    type = AriaLaserWeld304LStainlessSteel
    temperature = T
    beta = 1e7
  []
  [steel_boundary]
    type = AriaLaserWeld304LStainlessSteelBoundary
    boundary = &#x27;front&#x27;
    temperature = T
  []
  [const]
    type = GenericConstantMaterial
    prop_names = &#x27;abs sb_constant&#x27;
    prop_values = &#x27;1 ${sb}&#x27;
  []
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_mat_solver_type&#x27;
    petsc_options_value = &#x27;lu       NONZERO               strumpack&#x27;
  []
[]

[Executioner]
  type = Transient
  end_time = ${endtime}
  dtmin = 1e-8
  dtmax = ${timestep}
  petsc_options = &#x27;-snes_converged_reason -ksp_converged_reason -options_left&#x27;
  solve_type = &#x27;NEWTON&#x27;
  line_search = &#x27;none&#x27;
  nl_max_its = 12
  l_max_its = 100
  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    dt = ${timestep}
    linear_iteration_ratio = 1e6
    growth_factor = 1.5
  []
[]

[Outputs]
  [exodus]
    type = Exodus
    output_material_properties = true
    show_material_properties = &#x27;mu&#x27;
  []
  checkpoint = true
  perf_graph = true
[]

[Debug]
  show_var_residual_norms = true
[]


[Adaptivity]
  marker = combo
  max_h_level = 4

  [Indicators]
    [error_T]
      type = GradientJumpIndicator
      variable = T
    []
    [error_dispz]
      type = GradientJumpIndicator
      variable = disp_z
    []
  []

  [Markers]
    [errorfrac_T]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_T
    []
    [errorfrac_dispz]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_dispz
    []
    [combo]
      type = ComboMarker
      markers = &#x27;errorfrac_T errorfrac_dispz&#x27;
    []
  []
[]

[Postprocessors]
  [num_dofs]
    type = NumDOFs
    system = &#x27;NL&#x27;
  []
  [nl]
    type = NumNonlinearIterations
  []
  [tot_nl]
    type = CumulativeValuePostprocessor
    postprocessor = &#x27;nl&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="62a1195f-40fe-4787-9b4d-135c62ff11b7"><div class="modal-content"><h4>(moose/modules/navier_stokes/examples/laser-welding/3d.i)</h4><pre class="moose-pre"><code class="language-text">period=1.25e-3
endtime=${period}
timestep=1.25e-5
surfacetemp=300
sb=5.67e-8

[GlobalParams]
  temperature = T
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  xmin = -.35e-3
  xmax = 0.35e-3
  ymin = -.35e-3
  ymax = .35e-3
  zmin = -.7e-3
  zmax = 0
  nx = 2
  ny = 2
  nz = 2
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  uniform_refine = 2
[]

[Variables]
  [vel]
    family = LAGRANGE_VEC
  []
  [T]
  []
  [p]
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[ICs]
  [T]
    type = FunctionIC
    variable = T
    function = &#x27;(${surfacetemp} - 300) / .7e-3 * z + ${surfacetemp}&#x27;
  []
[]

[Kernels]
  [disp_x]
    type = Diffusion
    variable = disp_x
  []
  [disp_y]
    type = Diffusion
    variable = disp_y
  []
  [disp_z]
    type = Diffusion
    variable = disp_z
  []
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]

[BCs]
  [x_no_disp]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;back&#x27;
    value = 0
  []
  [y_no_disp]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back&#x27;
    value = 0
  []
  [z_no_disp]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0
  []
  [no_slip]
    type = ADVectorFunctionDirichletBC
    variable = vel
    boundary = &#x27;bottom right left top back&#x27;
  []
  [T_cold]
    type = DirichletBC
    variable = T
    boundary = &#x27;back&#x27;
    value = 300
  []
  [radiation_flux]
    type = FunctionRadiativeBC
    variable = T
    boundary = &#x27;front&#x27;
    emissivity_function = &#x27;1&#x27;
    Tinfinity = 300
    stefan_boltzmann_constant = ${sb}
    use_displaced_mesh = true
  []
  [weld_flux]
    type = GaussianEnergyFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    P0 = 159.96989792079225
    R = 1.8257418583505537e-4
    x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
    y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
    z_beam_coord = 0
    use_displaced_mesh = true
  []
  [vapor_recoil]
    type = INSADVaporRecoilPressureMomentumFluxBC
    variable = vel
    boundary = &#x27;front&#x27;
    use_displaced_mesh = true
  []
  [displace_x_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
  [displace_x_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
[]

[Materials]
  [ins_mat]
    type = INSADStabilized3Eqn
    velocity = vel
    pressure = p
    temperature = T
    use_displaced_mesh = true
  []
  [steel]
    type = AriaLaserWeld304LStainlessSteel
    temperature = T
    beta = 1e7
  []
  [steel_boundary]
    type = AriaLaserWeld304LStainlessSteelBoundary
    boundary = &#x27;front&#x27;
    temperature = T
  []
  [const]
    type = GenericConstantMaterial
    prop_names = &#x27;abs sb_constant&#x27;
    prop_values = &#x27;1 ${sb}&#x27;
  []
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_mat_solver_type&#x27;
    petsc_options_value = &#x27;lu       NONZERO               strumpack&#x27;
  []
[]

[Executioner]
  type = Transient
  end_time = ${endtime}
  dtmin = 1e-8
  dtmax = ${timestep}
  petsc_options = &#x27;-snes_converged_reason -ksp_converged_reason -options_left&#x27;
  solve_type = &#x27;NEWTON&#x27;
  line_search = &#x27;none&#x27;
  nl_max_its = 12
  l_max_its = 100
  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    dt = ${timestep}
    linear_iteration_ratio = 1e6
    growth_factor = 1.5
  []
[]

[Outputs]
  [exodus]
    type = Exodus
    output_material_properties = true
    show_material_properties = &#x27;mu&#x27;
  []
  checkpoint = true
  perf_graph = true
[]

[Debug]
  show_var_residual_norms = true
[]


[Adaptivity]
  marker = combo
  max_h_level = 4

  [Indicators]
    [error_T]
      type = GradientJumpIndicator
      variable = T
    []
    [error_dispz]
      type = GradientJumpIndicator
      variable = disp_z
    []
  []

  [Markers]
    [errorfrac_T]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_T
    []
    [errorfrac_dispz]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_dispz
    []
    [combo]
      type = ComboMarker
      markers = &#x27;errorfrac_T errorfrac_dispz&#x27;
    []
  []
[]

[Postprocessors]
  [num_dofs]
    type = NumDOFs
    system = &#x27;NL&#x27;
  []
  [nl]
    type = NumNonlinearIterations
  []
  [tot_nl]
    type = CumulativeValuePostprocessor
    postprocessor = &#x27;nl&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="22851f00-6e56-4d41-9e11-24ec92ddefad"><div class="modal-content"><h4>(moose/modules/navier_stokes/examples/laser-welding/3d.i)</h4><pre class="moose-pre"><code class="language-text">period=1.25e-3
endtime=${period}
timestep=1.25e-5
surfacetemp=300
sb=5.67e-8

[GlobalParams]
  temperature = T
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  xmin = -.35e-3
  xmax = 0.35e-3
  ymin = -.35e-3
  ymax = .35e-3
  zmin = -.7e-3
  zmax = 0
  nx = 2
  ny = 2
  nz = 2
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  uniform_refine = 2
[]

[Variables]
  [vel]
    family = LAGRANGE_VEC
  []
  [T]
  []
  [p]
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[ICs]
  [T]
    type = FunctionIC
    variable = T
    function = &#x27;(${surfacetemp} - 300) / .7e-3 * z + ${surfacetemp}&#x27;
  []
[]

[Kernels]
  [disp_x]
    type = Diffusion
    variable = disp_x
  []
  [disp_y]
    type = Diffusion
    variable = disp_y
  []
  [disp_z]
    type = Diffusion
    variable = disp_z
  []
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]

[BCs]
  [x_no_disp]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;back&#x27;
    value = 0
  []
  [y_no_disp]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back&#x27;
    value = 0
  []
  [z_no_disp]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0
  []
  [no_slip]
    type = ADVectorFunctionDirichletBC
    variable = vel
    boundary = &#x27;bottom right left top back&#x27;
  []
  [T_cold]
    type = DirichletBC
    variable = T
    boundary = &#x27;back&#x27;
    value = 300
  []
  [radiation_flux]
    type = FunctionRadiativeBC
    variable = T
    boundary = &#x27;front&#x27;
    emissivity_function = &#x27;1&#x27;
    Tinfinity = 300
    stefan_boltzmann_constant = ${sb}
    use_displaced_mesh = true
  []
  [weld_flux]
    type = GaussianEnergyFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    P0 = 159.96989792079225
    R = 1.8257418583505537e-4
    x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
    y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
    z_beam_coord = 0
    use_displaced_mesh = true
  []
  [vapor_recoil]
    type = INSADVaporRecoilPressureMomentumFluxBC
    variable = vel
    boundary = &#x27;front&#x27;
    use_displaced_mesh = true
  []
  [displace_x_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
  [displace_x_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
[]

[Materials]
  [ins_mat]
    type = INSADStabilized3Eqn
    velocity = vel
    pressure = p
    temperature = T
    use_displaced_mesh = true
  []
  [steel]
    type = AriaLaserWeld304LStainlessSteel
    temperature = T
    beta = 1e7
  []
  [steel_boundary]
    type = AriaLaserWeld304LStainlessSteelBoundary
    boundary = &#x27;front&#x27;
    temperature = T
  []
  [const]
    type = GenericConstantMaterial
    prop_names = &#x27;abs sb_constant&#x27;
    prop_values = &#x27;1 ${sb}&#x27;
  []
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_mat_solver_type&#x27;
    petsc_options_value = &#x27;lu       NONZERO               strumpack&#x27;
  []
[]

[Executioner]
  type = Transient
  end_time = ${endtime}
  dtmin = 1e-8
  dtmax = ${timestep}
  petsc_options = &#x27;-snes_converged_reason -ksp_converged_reason -options_left&#x27;
  solve_type = &#x27;NEWTON&#x27;
  line_search = &#x27;none&#x27;
  nl_max_its = 12
  l_max_its = 100
  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    dt = ${timestep}
    linear_iteration_ratio = 1e6
    growth_factor = 1.5
  []
[]

[Outputs]
  [exodus]
    type = Exodus
    output_material_properties = true
    show_material_properties = &#x27;mu&#x27;
  []
  checkpoint = true
  perf_graph = true
[]

[Debug]
  show_var_residual_norms = true
[]


[Adaptivity]
  marker = combo
  max_h_level = 4

  [Indicators]
    [error_T]
      type = GradientJumpIndicator
      variable = T
    []
    [error_dispz]
      type = GradientJumpIndicator
      variable = disp_z
    []
  []

  [Markers]
    [errorfrac_T]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_T
    []
    [errorfrac_dispz]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_dispz
    []
    [combo]
      type = ComboMarker
      markers = &#x27;errorfrac_T errorfrac_dispz&#x27;
    []
  []
[]

[Postprocessors]
  [num_dofs]
    type = NumDOFs
    system = &#x27;NL&#x27;
  []
  [nl]
    type = NumNonlinearIterations
  []
  [tot_nl]
    type = CumulativeValuePostprocessor
    postprocessor = &#x27;nl&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="8ab3f351-b9fd-4229-aff0-9f4ff71a7e75"><div class="modal-content"><h4>(moose/modules/navier_stokes/examples/laser-welding/3d.i)</h4><pre class="moose-pre"><code class="language-text">period=1.25e-3
endtime=${period}
timestep=1.25e-5
surfacetemp=300
sb=5.67e-8

[GlobalParams]
  temperature = T
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  xmin = -.35e-3
  xmax = 0.35e-3
  ymin = -.35e-3
  ymax = .35e-3
  zmin = -.7e-3
  zmax = 0
  nx = 2
  ny = 2
  nz = 2
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  uniform_refine = 2
[]

[Variables]
  [vel]
    family = LAGRANGE_VEC
  []
  [T]
  []
  [p]
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[ICs]
  [T]
    type = FunctionIC
    variable = T
    function = &#x27;(${surfacetemp} - 300) / .7e-3 * z + ${surfacetemp}&#x27;
  []
[]

[Kernels]
  [disp_x]
    type = Diffusion
    variable = disp_x
  []
  [disp_y]
    type = Diffusion
    variable = disp_y
  []
  [disp_z]
    type = Diffusion
    variable = disp_z
  []
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]

[BCs]
  [x_no_disp]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;back&#x27;
    value = 0
  []
  [y_no_disp]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back&#x27;
    value = 0
  []
  [z_no_disp]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0
  []
  [no_slip]
    type = ADVectorFunctionDirichletBC
    variable = vel
    boundary = &#x27;bottom right left top back&#x27;
  []
  [T_cold]
    type = DirichletBC
    variable = T
    boundary = &#x27;back&#x27;
    value = 300
  []
  [radiation_flux]
    type = FunctionRadiativeBC
    variable = T
    boundary = &#x27;front&#x27;
    emissivity_function = &#x27;1&#x27;
    Tinfinity = 300
    stefan_boltzmann_constant = ${sb}
    use_displaced_mesh = true
  []
  [weld_flux]
    type = GaussianEnergyFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    P0 = 159.96989792079225
    R = 1.8257418583505537e-4
    x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
    y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
    z_beam_coord = 0
    use_displaced_mesh = true
  []
  [vapor_recoil]
    type = INSADVaporRecoilPressureMomentumFluxBC
    variable = vel
    boundary = &#x27;front&#x27;
    use_displaced_mesh = true
  []
  [displace_x_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
  [displace_x_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
[]

[Materials]
  [ins_mat]
    type = INSADStabilized3Eqn
    velocity = vel
    pressure = p
    temperature = T
    use_displaced_mesh = true
  []
  [steel]
    type = AriaLaserWeld304LStainlessSteel
    temperature = T
    beta = 1e7
  []
  [steel_boundary]
    type = AriaLaserWeld304LStainlessSteelBoundary
    boundary = &#x27;front&#x27;
    temperature = T
  []
  [const]
    type = GenericConstantMaterial
    prop_names = &#x27;abs sb_constant&#x27;
    prop_values = &#x27;1 ${sb}&#x27;
  []
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_mat_solver_type&#x27;
    petsc_options_value = &#x27;lu       NONZERO               strumpack&#x27;
  []
[]

[Executioner]
  type = Transient
  end_time = ${endtime}
  dtmin = 1e-8
  dtmax = ${timestep}
  petsc_options = &#x27;-snes_converged_reason -ksp_converged_reason -options_left&#x27;
  solve_type = &#x27;NEWTON&#x27;
  line_search = &#x27;none&#x27;
  nl_max_its = 12
  l_max_its = 100
  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    dt = ${timestep}
    linear_iteration_ratio = 1e6
    growth_factor = 1.5
  []
[]

[Outputs]
  [exodus]
    type = Exodus
    output_material_properties = true
    show_material_properties = &#x27;mu&#x27;
  []
  checkpoint = true
  perf_graph = true
[]

[Debug]
  show_var_residual_norms = true
[]


[Adaptivity]
  marker = combo
  max_h_level = 4

  [Indicators]
    [error_T]
      type = GradientJumpIndicator
      variable = T
    []
    [error_dispz]
      type = GradientJumpIndicator
      variable = disp_z
    []
  []

  [Markers]
    [errorfrac_T]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_T
    []
    [errorfrac_dispz]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_dispz
    []
    [combo]
      type = ComboMarker
      markers = &#x27;errorfrac_T errorfrac_dispz&#x27;
    []
  []
[]

[Postprocessors]
  [num_dofs]
    type = NumDOFs
    system = &#x27;NL&#x27;
  []
  [nl]
    type = NumNonlinearIterations
  []
  [tot_nl]
    type = CumulativeValuePostprocessor
    postprocessor = &#x27;nl&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="d547e45e-185e-4914-ac94-aa76aada9d00"><div class="modal-content"><h4>(moose/modules/navier_stokes/examples/laser-welding/3d.i)</h4><pre class="moose-pre"><code class="language-text">period=1.25e-3
endtime=${period}
timestep=1.25e-5
surfacetemp=300
sb=5.67e-8

[GlobalParams]
  temperature = T
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  xmin = -.35e-3
  xmax = 0.35e-3
  ymin = -.35e-3
  ymax = .35e-3
  zmin = -.7e-3
  zmax = 0
  nx = 2
  ny = 2
  nz = 2
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  uniform_refine = 2
[]

[Variables]
  [vel]
    family = LAGRANGE_VEC
  []
  [T]
  []
  [p]
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[ICs]
  [T]
    type = FunctionIC
    variable = T
    function = &#x27;(${surfacetemp} - 300) / .7e-3 * z + ${surfacetemp}&#x27;
  []
[]

[Kernels]
  [disp_x]
    type = Diffusion
    variable = disp_x
  []
  [disp_y]
    type = Diffusion
    variable = disp_y
  []
  [disp_z]
    type = Diffusion
    variable = disp_z
  []
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]

[BCs]
  [x_no_disp]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;back&#x27;
    value = 0
  []
  [y_no_disp]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back&#x27;
    value = 0
  []
  [z_no_disp]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0
  []
  [no_slip]
    type = ADVectorFunctionDirichletBC
    variable = vel
    boundary = &#x27;bottom right left top back&#x27;
  []
  [T_cold]
    type = DirichletBC
    variable = T
    boundary = &#x27;back&#x27;
    value = 300
  []
  [radiation_flux]
    type = FunctionRadiativeBC
    variable = T
    boundary = &#x27;front&#x27;
    emissivity_function = &#x27;1&#x27;
    Tinfinity = 300
    stefan_boltzmann_constant = ${sb}
    use_displaced_mesh = true
  []
  [weld_flux]
    type = GaussianEnergyFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    P0 = 159.96989792079225
    R = 1.8257418583505537e-4
    x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
    y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
    z_beam_coord = 0
    use_displaced_mesh = true
  []
  [vapor_recoil]
    type = INSADVaporRecoilPressureMomentumFluxBC
    variable = vel
    boundary = &#x27;front&#x27;
    use_displaced_mesh = true
  []
  [displace_x_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
  [displace_x_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
[]

[Materials]
  [ins_mat]
    type = INSADStabilized3Eqn
    velocity = vel
    pressure = p
    temperature = T
    use_displaced_mesh = true
  []
  [steel]
    type = AriaLaserWeld304LStainlessSteel
    temperature = T
    beta = 1e7
  []
  [steel_boundary]
    type = AriaLaserWeld304LStainlessSteelBoundary
    boundary = &#x27;front&#x27;
    temperature = T
  []
  [const]
    type = GenericConstantMaterial
    prop_names = &#x27;abs sb_constant&#x27;
    prop_values = &#x27;1 ${sb}&#x27;
  []
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_mat_solver_type&#x27;
    petsc_options_value = &#x27;lu       NONZERO               strumpack&#x27;
  []
[]

[Executioner]
  type = Transient
  end_time = ${endtime}
  dtmin = 1e-8
  dtmax = ${timestep}
  petsc_options = &#x27;-snes_converged_reason -ksp_converged_reason -options_left&#x27;
  solve_type = &#x27;NEWTON&#x27;
  line_search = &#x27;none&#x27;
  nl_max_its = 12
  l_max_its = 100
  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    dt = ${timestep}
    linear_iteration_ratio = 1e6
    growth_factor = 1.5
  []
[]

[Outputs]
  [exodus]
    type = Exodus
    output_material_properties = true
    show_material_properties = &#x27;mu&#x27;
  []
  checkpoint = true
  perf_graph = true
[]

[Debug]
  show_var_residual_norms = true
[]


[Adaptivity]
  marker = combo
  max_h_level = 4

  [Indicators]
    [error_T]
      type = GradientJumpIndicator
      variable = T
    []
    [error_dispz]
      type = GradientJumpIndicator
      variable = disp_z
    []
  []

  [Markers]
    [errorfrac_T]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_T
    []
    [errorfrac_dispz]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_dispz
    []
    [combo]
      type = ComboMarker
      markers = &#x27;errorfrac_T errorfrac_dispz&#x27;
    []
  []
[]

[Postprocessors]
  [num_dofs]
    type = NumDOFs
    system = &#x27;NL&#x27;
  []
  [nl]
    type = NumNonlinearIterations
  []
  [tot_nl]
    type = CumulativeValuePostprocessor
    postprocessor = &#x27;nl&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="8101299a-7527-49f6-b4da-38e91715cc87"><div class="modal-content"><h4>(moose/modules/navier_stokes/examples/laser-welding/3d.i)</h4><pre class="moose-pre"><code class="language-text">period=1.25e-3
endtime=${period}
timestep=1.25e-5
surfacetemp=300
sb=5.67e-8

[GlobalParams]
  temperature = T
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  xmin = -.35e-3
  xmax = 0.35e-3
  ymin = -.35e-3
  ymax = .35e-3
  zmin = -.7e-3
  zmax = 0
  nx = 2
  ny = 2
  nz = 2
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  uniform_refine = 2
[]

[Variables]
  [vel]
    family = LAGRANGE_VEC
  []
  [T]
  []
  [p]
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[ICs]
  [T]
    type = FunctionIC
    variable = T
    function = &#x27;(${surfacetemp} - 300) / .7e-3 * z + ${surfacetemp}&#x27;
  []
[]

[Kernels]
  [disp_x]
    type = Diffusion
    variable = disp_x
  []
  [disp_y]
    type = Diffusion
    variable = disp_y
  []
  [disp_z]
    type = Diffusion
    variable = disp_z
  []
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]

[BCs]
  [x_no_disp]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;back&#x27;
    value = 0
  []
  [y_no_disp]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back&#x27;
    value = 0
  []
  [z_no_disp]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0
  []
  [no_slip]
    type = ADVectorFunctionDirichletBC
    variable = vel
    boundary = &#x27;bottom right left top back&#x27;
  []
  [T_cold]
    type = DirichletBC
    variable = T
    boundary = &#x27;back&#x27;
    value = 300
  []
  [radiation_flux]
    type = FunctionRadiativeBC
    variable = T
    boundary = &#x27;front&#x27;
    emissivity_function = &#x27;1&#x27;
    Tinfinity = 300
    stefan_boltzmann_constant = ${sb}
    use_displaced_mesh = true
  []
  [weld_flux]
    type = GaussianEnergyFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    P0 = 159.96989792079225
    R = 1.8257418583505537e-4
    x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
    y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
    z_beam_coord = 0
    use_displaced_mesh = true
  []
  [vapor_recoil]
    type = INSADVaporRecoilPressureMomentumFluxBC
    variable = vel
    boundary = &#x27;front&#x27;
    use_displaced_mesh = true
  []
  [displace_x_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
  [displace_x_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
[]

[Materials]
  [ins_mat]
    type = INSADStabilized3Eqn
    velocity = vel
    pressure = p
    temperature = T
    use_displaced_mesh = true
  []
  [steel]
    type = AriaLaserWeld304LStainlessSteel
    temperature = T
    beta = 1e7
  []
  [steel_boundary]
    type = AriaLaserWeld304LStainlessSteelBoundary
    boundary = &#x27;front&#x27;
    temperature = T
  []
  [const]
    type = GenericConstantMaterial
    prop_names = &#x27;abs sb_constant&#x27;
    prop_values = &#x27;1 ${sb}&#x27;
  []
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_mat_solver_type&#x27;
    petsc_options_value = &#x27;lu       NONZERO               strumpack&#x27;
  []
[]

[Executioner]
  type = Transient
  end_time = ${endtime}
  dtmin = 1e-8
  dtmax = ${timestep}
  petsc_options = &#x27;-snes_converged_reason -ksp_converged_reason -options_left&#x27;
  solve_type = &#x27;NEWTON&#x27;
  line_search = &#x27;none&#x27;
  nl_max_its = 12
  l_max_its = 100
  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    dt = ${timestep}
    linear_iteration_ratio = 1e6
    growth_factor = 1.5
  []
[]

[Outputs]
  [exodus]
    type = Exodus
    output_material_properties = true
    show_material_properties = &#x27;mu&#x27;
  []
  checkpoint = true
  perf_graph = true
[]

[Debug]
  show_var_residual_norms = true
[]


[Adaptivity]
  marker = combo
  max_h_level = 4

  [Indicators]
    [error_T]
      type = GradientJumpIndicator
      variable = T
    []
    [error_dispz]
      type = GradientJumpIndicator
      variable = disp_z
    []
  []

  [Markers]
    [errorfrac_T]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_T
    []
    [errorfrac_dispz]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_dispz
    []
    [combo]
      type = ComboMarker
      markers = &#x27;errorfrac_T errorfrac_dispz&#x27;
    []
  []
[]

[Postprocessors]
  [num_dofs]
    type = NumDOFs
    system = &#x27;NL&#x27;
  []
  [nl]
    type = NumNonlinearIterations
  []
  [tot_nl]
    type = CumulativeValuePostprocessor
    postprocessor = &#x27;nl&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="489aaf62-4f69-4eea-9b23-0d15e34ffce0"><div class="modal-content"><h4>(moose/modules/navier_stokes/examples/laser-welding/3d.i)</h4><pre class="moose-pre"><code class="language-text">period=1.25e-3
endtime=${period}
timestep=1.25e-5
surfacetemp=300
sb=5.67e-8

[GlobalParams]
  temperature = T
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  xmin = -.35e-3
  xmax = 0.35e-3
  ymin = -.35e-3
  ymax = .35e-3
  zmin = -.7e-3
  zmax = 0
  nx = 2
  ny = 2
  nz = 2
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  uniform_refine = 2
[]

[Variables]
  [vel]
    family = LAGRANGE_VEC
  []
  [T]
  []
  [p]
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[ICs]
  [T]
    type = FunctionIC
    variable = T
    function = &#x27;(${surfacetemp} - 300) / .7e-3 * z + ${surfacetemp}&#x27;
  []
[]

[Kernels]
  [disp_x]
    type = Diffusion
    variable = disp_x
  []
  [disp_y]
    type = Diffusion
    variable = disp_y
  []
  [disp_z]
    type = Diffusion
    variable = disp_z
  []
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]

[BCs]
  [x_no_disp]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;back&#x27;
    value = 0
  []
  [y_no_disp]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back&#x27;
    value = 0
  []
  [z_no_disp]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0
  []
  [no_slip]
    type = ADVectorFunctionDirichletBC
    variable = vel
    boundary = &#x27;bottom right left top back&#x27;
  []
  [T_cold]
    type = DirichletBC
    variable = T
    boundary = &#x27;back&#x27;
    value = 300
  []
  [radiation_flux]
    type = FunctionRadiativeBC
    variable = T
    boundary = &#x27;front&#x27;
    emissivity_function = &#x27;1&#x27;
    Tinfinity = 300
    stefan_boltzmann_constant = ${sb}
    use_displaced_mesh = true
  []
  [weld_flux]
    type = GaussianEnergyFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    P0 = 159.96989792079225
    R = 1.8257418583505537e-4
    x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
    y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
    z_beam_coord = 0
    use_displaced_mesh = true
  []
  [vapor_recoil]
    type = INSADVaporRecoilPressureMomentumFluxBC
    variable = vel
    boundary = &#x27;front&#x27;
    use_displaced_mesh = true
  []
  [displace_x_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
  [displace_x_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
[]

[Materials]
  [ins_mat]
    type = INSADStabilized3Eqn
    velocity = vel
    pressure = p
    temperature = T
    use_displaced_mesh = true
  []
  [steel]
    type = AriaLaserWeld304LStainlessSteel
    temperature = T
    beta = 1e7
  []
  [steel_boundary]
    type = AriaLaserWeld304LStainlessSteelBoundary
    boundary = &#x27;front&#x27;
    temperature = T
  []
  [const]
    type = GenericConstantMaterial
    prop_names = &#x27;abs sb_constant&#x27;
    prop_values = &#x27;1 ${sb}&#x27;
  []
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_mat_solver_type&#x27;
    petsc_options_value = &#x27;lu       NONZERO               strumpack&#x27;
  []
[]

[Executioner]
  type = Transient
  end_time = ${endtime}
  dtmin = 1e-8
  dtmax = ${timestep}
  petsc_options = &#x27;-snes_converged_reason -ksp_converged_reason -options_left&#x27;
  solve_type = &#x27;NEWTON&#x27;
  line_search = &#x27;none&#x27;
  nl_max_its = 12
  l_max_its = 100
  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    dt = ${timestep}
    linear_iteration_ratio = 1e6
    growth_factor = 1.5
  []
[]

[Outputs]
  [exodus]
    type = Exodus
    output_material_properties = true
    show_material_properties = &#x27;mu&#x27;
  []
  checkpoint = true
  perf_graph = true
[]

[Debug]
  show_var_residual_norms = true
[]


[Adaptivity]
  marker = combo
  max_h_level = 4

  [Indicators]
    [error_T]
      type = GradientJumpIndicator
      variable = T
    []
    [error_dispz]
      type = GradientJumpIndicator
      variable = disp_z
    []
  []

  [Markers]
    [errorfrac_T]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_T
    []
    [errorfrac_dispz]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_dispz
    []
    [combo]
      type = ComboMarker
      markers = &#x27;errorfrac_T errorfrac_dispz&#x27;
    []
  []
[]

[Postprocessors]
  [num_dofs]
    type = NumDOFs
    system = &#x27;NL&#x27;
  []
  [nl]
    type = NumNonlinearIterations
  []
  [tot_nl]
    type = CumulativeValuePostprocessor
    postprocessor = &#x27;nl&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="09400f70-2fe7-4d2e-8514-4d06719058eb"><div class="modal-content"><h4>(moose/modules/navier_stokes/examples/laser-welding/3d.i)</h4><pre class="moose-pre"><code class="language-text">period=1.25e-3
endtime=${period}
timestep=1.25e-5
surfacetemp=300
sb=5.67e-8

[GlobalParams]
  temperature = T
[]

[Mesh]
  type = GeneratedMesh
  dim = 3
  xmin = -.35e-3
  xmax = 0.35e-3
  ymin = -.35e-3
  ymax = .35e-3
  zmin = -.7e-3
  zmax = 0
  nx = 2
  ny = 2
  nz = 2
  displacements = &#x27;disp_x disp_y disp_z&#x27;
  uniform_refine = 2
[]

[Variables]
  [vel]
    family = LAGRANGE_VEC
  []
  [T]
  []
  [p]
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[ICs]
  [T]
    type = FunctionIC
    variable = T
    function = &#x27;(${surfacetemp} - 300) / .7e-3 * z + ${surfacetemp}&#x27;
  []
[]

[Kernels]
  [disp_x]
    type = Diffusion
    variable = disp_x
  []
  [disp_y]
    type = Diffusion
    variable = disp_y
  []
  [disp_z]
    type = Diffusion
    variable = disp_z
  []
  [mass]
    type = INSADMass
    variable = p
    use_displaced_mesh = true
  []
  [mass_pspg]
    type = INSADMassPSPG
    variable = p
    use_displaced_mesh = true
  []
  [momentum_time]
    type = INSADMomentumTimeDerivative
    variable = vel
    use_displaced_mesh = true
  []
  [mesh]
    type = INSADMeshConvection
    variable = vel
    disp_x = disp_x
    disp_y = disp_y
    disp_z = disp_z
    use_displaced_mesh = true
  []
  [momentum_convection]
    type = INSADMomentumAdvection
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_viscous]
    type = INSADMomentumViscous
    variable = vel
    use_displaced_mesh = true
  []
  [momentum_pressure]
    type = INSADMomentumPressure
    variable = vel
    pressure = p
    integrate_p_by_parts = true
    use_displaced_mesh = true
  []
  [momentum_supg]
    type = INSADMomentumSUPG
    variable = vel
    velocity = vel
    use_displaced_mesh = true
  []
  [temperature_advection]
    type = INSADEnergyAdvection
    variable = T
    use_displaced_mesh = true
  []
  [temperature_time]
    type = INSADHeatConductionTimeDerivative
    variable = T
    use_displaced_mesh = true
  []
  [temperature_conduction]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = &#x27;k&#x27;
    use_displaced_mesh = true
  []
  [temperature_supg]
    type = INSADEnergySUPG
    variable = T
    velocity = vel
    use_displaced_mesh = true
  []
[]

[BCs]
  [x_no_disp]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;back&#x27;
    value = 0
  []
  [y_no_disp]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;back&#x27;
    value = 0
  []
  [z_no_disp]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;back&#x27;
    value = 0
  []
  [no_slip]
    type = ADVectorFunctionDirichletBC
    variable = vel
    boundary = &#x27;bottom right left top back&#x27;
  []
  [T_cold]
    type = DirichletBC
    variable = T
    boundary = &#x27;back&#x27;
    value = 300
  []
  [radiation_flux]
    type = FunctionRadiativeBC
    variable = T
    boundary = &#x27;front&#x27;
    emissivity_function = &#x27;1&#x27;
    Tinfinity = 300
    stefan_boltzmann_constant = ${sb}
    use_displaced_mesh = true
  []
  [weld_flux]
    type = GaussianEnergyFluxBC
    variable = T
    boundary = &#x27;front&#x27;
    P0 = 159.96989792079225
    R = 1.8257418583505537e-4
    x_beam_coord = &#x27;2e-4 * cos(t * 2 * pi / ${period})&#x27;
    y_beam_coord = &#x27;2e-4 * sin(t * 2 * pi / ${period})&#x27;
    z_beam_coord = 0
    use_displaced_mesh = true
  []
  [vapor_recoil]
    type = INSADVaporRecoilPressureMomentumFluxBC
    variable = vel
    boundary = &#x27;front&#x27;
    use_displaced_mesh = true
  []
  [displace_x_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top]
    type = INSADDisplaceBoundaryBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
  [displace_x_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_x&#x27;
    velocity = &#x27;vel&#x27;
    component = 0
  []
  [displace_y_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_y&#x27;
    velocity = &#x27;vel&#x27;
    component = 1
  []
  [displace_z_top_dummy]
    type = INSADDummyDisplaceBoundaryIntegratedBC
    boundary = &#x27;front&#x27;
    variable = &#x27;disp_z&#x27;
    velocity = &#x27;vel&#x27;
    component = 2
  []
[]

[Materials]
  [ins_mat]
    type = INSADStabilized3Eqn
    velocity = vel
    pressure = p
    temperature = T
    use_displaced_mesh = true
  []
  [steel]
    type = AriaLaserWeld304LStainlessSteel
    temperature = T
    beta = 1e7
  []
  [steel_boundary]
    type = AriaLaserWeld304LStainlessSteelBoundary
    boundary = &#x27;front&#x27;
    temperature = T
  []
  [const]
    type = GenericConstantMaterial
    prop_names = &#x27;abs sb_constant&#x27;
    prop_values = &#x27;1 ${sb}&#x27;
  []
[]

[Preconditioning]
  [SMP]
    type = SMP
    full = true
    petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_mat_solver_type&#x27;
    petsc_options_value = &#x27;lu       NONZERO               strumpack&#x27;
  []
[]

[Executioner]
  type = Transient
  end_time = ${endtime}
  dtmin = 1e-8
  dtmax = ${timestep}
  petsc_options = &#x27;-snes_converged_reason -ksp_converged_reason -options_left&#x27;
  solve_type = &#x27;NEWTON&#x27;
  line_search = &#x27;none&#x27;
  nl_max_its = 12
  l_max_its = 100
  [TimeStepper]
    type = IterationAdaptiveDT
    optimal_iterations = 7
    dt = ${timestep}
    linear_iteration_ratio = 1e6
    growth_factor = 1.5
  []
[]

[Outputs]
  [exodus]
    type = Exodus
    output_material_properties = true
    show_material_properties = &#x27;mu&#x27;
  []
  checkpoint = true
  perf_graph = true
[]

[Debug]
  show_var_residual_norms = true
[]


[Adaptivity]
  marker = combo
  max_h_level = 4

  [Indicators]
    [error_T]
      type = GradientJumpIndicator
      variable = T
    []
    [error_dispz]
      type = GradientJumpIndicator
      variable = disp_z
    []
  []

  [Markers]
    [errorfrac_T]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_T
    []
    [errorfrac_dispz]
      type = ErrorFractionMarker
      refine = 0.4
      coarsen = 0.2
      indicator = error_dispz
    []
    [combo]
      type = ComboMarker
      markers = &#x27;errorfrac_T errorfrac_dispz&#x27;
    []
  []
[]

[Postprocessors]
  [num_dofs]
    type = NumDOFs
    system = &#x27;NL&#x27;
  []
  [nl]
    type = NumNonlinearIterations
  []
  [tot_nl]
    type = CumulativeValuePostprocessor
    postprocessor = &#x27;nl&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#db357587-b1e5-4445-9dcc-4b413f697e84" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>